(progn
    (import java
        (types java.lang.Runnable)
        (types java.lang.Thread))
    (obj Test [^Object]
        (def [[i ^int]])
        (ctor [] (ccall))
        (defn checkI ^int []
            (++ i)
            (#sleep ^Thread 0 10)
            (-- i)
            i))
    (app
        (defn test ^void []
            (catch [[_ ^java.lang.InterruptedException]]
                (for [_ (range 0 1000000)]
                    (#checkI ^Test))))
        (app-fn
            (def [
                [t0 (new ^Thread (rfn ^Runnable ^App test))]
                [t1 (new ^Thread (rfn ^Runnable ^App test))]]))))